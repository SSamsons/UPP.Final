# –û—Ç—á–µ—Ç –æ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–π

## ‚úÖ 1. Spring Boot Actuator - –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:
- ‚úÖ `/actuator/health` - —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ `/actuator/metrics` - —Ä–∞–±–æ—Ç–∞–µ—Ç, –¥–æ—Å—Ç—É–ø–Ω–æ 15+ –º–µ—Ç—Ä–∏–∫
- ‚úÖ `/actuator/prometheus` - —Ä–∞–±–æ—Ç–∞–µ—Ç, –º–µ—Ç—Ä–∏–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
- `crawler.parsing.duration` - –≤—Ä–µ–º—è –ø–∞—Ä—Å–∏–Ω–≥–∞
- `crawler.parsing.success` - —É—Å–ø–µ—à–Ω—ã–µ –ø–∞—Ä—Å–∏–Ω–≥–∏ (47)
- `crawler.parsing.errors` - –æ—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ (7)
- `crawler.database.records.inserted` - –∑–∞–ø–∏—Å–∏ –≤ –ë–î (11)
- `crawler.pages.crawled` - —Å—Ç—Ä–∞–Ω–∏—Ü –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ (55)
- `crawler.urls.visited` - URL –ø–æ—Å–µ—â–µ–Ω–æ (55)
- `http.server.requests` - HTTP –∑–∞–ø—Ä–æ—Å—ã (137 –∑–∞–ø—Ä–æ—Å–æ–≤, –º–∞–∫—Å. –≤—Ä–µ–º—è 0.046 —Å–µ–∫)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## ‚úÖ 2. Thread Dump –∏ HTTP Requests –º–µ—Ç—Ä–∏–∫–∏

### Thread Dump:
- ‚úÖ Endpoint `/actuator/threaddump` –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏

### HTTP Requests –º–µ—Ç—Ä–∏–∫–∏:
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∞ `http.server.requests` –¥–æ—Å—Ç—É–ø–Ω–∞
- ‚úÖ –°–æ–±–∏—Ä–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ:
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤: 137
  - –û–±—â–µ–µ –≤—Ä–µ–º—è: 5.15 —Å–µ–∫—É–Ω–¥
  - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è: 0.046 —Å–µ–∫—É–Ω–¥
  - –ú–µ—Ç–æ–¥—ã: GET
  - –°—Ç–∞—Ç—É—Å—ã: 200 (SUCCESS), 404 (CLIENT_ERROR)
  - URI: `/actuator/prometheus`, `/actuator/metrics`, `/actuator/health`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –¥–ª—è threaddump)

## ‚úÖ 3. Prometheus –∏ Grafana –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### Prometheus:
- ‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –î–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:9090
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `prometheus.yml` –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è —Å `/actuator/prometheus`

### Grafana:
- ‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –î–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:3000
- ‚úÖ –õ–æ–≥–∏–Ω: `admin`, –ø–∞—Ä–æ–ª—å: `admin`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞, —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–∞—à–±–æ—Ä–¥–∞ –≤ Grafana

## ‚ö†Ô∏è 4. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (@Transactional)

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
- ‚ö†Ô∏è –í `CrawlerService.saveCompanyIfNew()` –Ω–µ—Ç —è–≤–Ω–æ–π –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ `@Transactional`
- ‚úÖ Spring Data JPA –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –º–µ—Ç–æ–¥–æ–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- ‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å `@Transactional` –¥–ª—è —Å–µ—Ä–≤–∏—Å–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:
–î–æ–±–∞–≤–∏—Ç—å `@Transactional` –∫ –º–µ—Ç–æ–¥—É `saveCompanyIfNew()` –¥–ª—è —è–≤–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏.

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è —É–ª—É—á—à–µ–Ω–∏–µ

## ‚úÖ 5. –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ —Ç–∞–±–ª–∏—Ü–µ

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤ –º–æ–¥–µ–ª–∏ Company:
- ‚úÖ `idx_website` –Ω–∞ –ø–æ–ª–µ `website`
- ‚úÖ `idx_name` –Ω–∞ –ø–æ–ª–µ `name`
- ‚úÖ `idx_crawled_at` –Ω–∞ –ø–æ–ª–µ `crawled_at`
- ‚úÖ `idx_phone` –Ω–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ `phones` (—Ç–∞–±–ª–∏—Ü–∞ `company_phones`)
- ‚úÖ `idx_email` –Ω–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ `emails` (—Ç–∞–±–ª–∏—Ü–∞ `company_emails`)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–Ω–¥–µ–∫—Å—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üìä 6. –ò–∑–º–µ—Ä–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∏ –∑–∞–¥–µ—Ä–∂–∫–∏

### –¢–µ–∫—É—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏:
- **HTTP Requests:**
  - –í—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤: 137
  - –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è: ~0.038 —Å–µ–∫
  - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è: 0.046 —Å–µ–∫
  - –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å: ~69 –∑–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫ (–Ω–∞ –æ—Å–Ω–æ–≤–µ 137 –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞ ~2 —Å–µ–∫)

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
1. –°–æ–∑–¥–∞—Ç—å –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º JMeter –∏–ª–∏ Apache Bench
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ Grafana –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –º–µ—Ç—Ä–∏–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
3. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è latency (P50, P95, P99)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è, —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## üìù –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

| –§—É–Ω–∫—Ü–∏—è | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|---------|--------|------------|
| Actuator endpoints | ‚úÖ | –†–∞–±–æ—Ç–∞–µ—Ç |
| –ú–µ—Ç—Ä–∏–∫–∏ (health, info, metrics) | ‚úÖ | –†–∞–±–æ—Ç–∞–µ—Ç |
| Thread dump | ‚ö†Ô∏è | –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ |
| HTTP requests –º–µ—Ç—Ä–∏–∫–∏ | ‚úÖ | –†–∞–±–æ—Ç–∞–µ—Ç |
| Prometheus –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è | ‚úÖ | –†–∞–±–æ—Ç–∞–µ—Ç |
| Grafana | ‚úÖ | –ì–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é |
| –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ | ‚ö†Ô∏è | –¢—Ä–µ–±—É–µ—Ç—Å—è —É–ª—É—á—à–µ–Ω–∏–µ |
| –ò–Ω–¥–µ–∫—Å—ã –ë–î | ‚úÖ | –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã |
| –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚ö†Ô∏è | –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ |

## üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

1. **–î–æ–±–∞–≤–∏—Ç—å @Transactional:**
   ```java
   @Transactional
   private void saveCompanyIfNew(Company company) {
       // ...
   }
   ```

2. **–°–æ–∑–¥–∞—Ç—å –Ω–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å JMeter –∏–ª–∏ Apache Bench
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ endpoints
   - –ò–∑–º–µ—Ä–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∏ latency

3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Grafana –¥–∞—à–±–æ—Ä–¥:**
   - –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π –¥–∞—à–±–æ—Ä–¥ –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–π
   - –î–æ–±–∞–≤–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫ crawler
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã

4. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ threaddump endpoint
